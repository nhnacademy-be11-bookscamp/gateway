server:
  port: 8080

spring:
  application:
    name: gateway
  webflux:
    multipart:
      max-in-memory-size: 5MB
  cloud:
    gateway:
      globalcors:
        # ğŸ’¡ [í•„ìˆ˜] CORS ì •ì±…ì„ ì ìš©í•  ê²½ë¡œ íŒ¨í„´ì…ë‹ˆë‹¤.
        # ëª¨ë“  ê²½ë¡œì— ì ìš©í•˜ë ¤ë©´ '/**'ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.
        corsConfigurations:
          '[/**]':
            # ğŸ’¡ [í•„ìˆ˜] ì ‘ê·¼ì„ í—ˆìš©í•  ì¶œì²˜(Origin)ë¥¼ ì§€ì •í•©ë‹ˆë‹¤.
            # http://localhost:8082ì—ì„œ ìš”ì²­ì´ ì˜¤ë¯€ë¡œ ì´ë¥¼ ëª…ì‹œí•©ë‹ˆë‹¤.
            # ì—¬ëŸ¬ ê°œì¼ ê²½ìš° ì‰¼í‘œë¡œ êµ¬ë¶„í•©ë‹ˆë‹¤.
            allowedOrigins:
              - "https://bookscamp.store"
              - "https://www.bookscamp.store"
              - "http://localhost:8082"
              - "http://127.0.0.1:8082"

            # ğŸ’¡ [í•„ìˆ˜] í—ˆìš©í•  HTTP ë©”ì„œë“œë¥¼ ì§€ì •í•©ë‹ˆë‹¤.
            # GET, POST, PUT, DELETE, OPTIONS ë“±ì„ í¬í•¨í•©ë‹ˆë‹¤.
            allowedMethods:
              - GET
              - POST
              - PUT
              - DELETE
              - OPTIONS

            # ğŸ’¡ [ì„ íƒ] ìš”ì²­ ì‹œ í—ˆìš©í•  í—¤ë”ë¥¼ ì§€ì •í•©ë‹ˆë‹¤. '*'ëŠ” ëª¨ë“  í—¤ë”ë¥¼ í—ˆìš©í•©ë‹ˆë‹¤.
            allowedHeaders:
              - "*"

            # ğŸ’¡ [ì„ íƒ] ìê²© ì¦ëª…(ì¿ í‚¤, ì¸ì¦ í—¤ë”) ì „ì†¡ì„ í—ˆìš©í• ì§€ ì—¬ë¶€ì…ë‹ˆë‹¤.
            # í”„ë¡ íŠ¸ì—”ë“œê°€ ì¿ í‚¤ë‚˜ Authorization í—¤ë”ë¥¼ ë³´ë‚¼ ê²½ìš° trueë¡œ ì„¤ì •í•´ì•¼ í•©ë‹ˆë‹¤.
            allowCredentials: true

            # ğŸ’¡ [ì„ íƒ] ë¸Œë¼ìš°ì €ê°€ pre-flight (OPTIONS) ì‘ë‹µì„ ìºì‹œí•  ì‹œê°„(ì´ˆ)ì„ ì§€ì •í•©ë‹ˆë‹¤.
            maxAge: 3600 # 1ì‹œê°„
      httpclient:
        netty:
          connect-timeout: 5000
          response-timeout: 15s
          pool:
            type: elastic
          wiretap: true
      server:
        webflux:
          routes:
            - id: api-service
              uri: lb://api-server
              predicates:
                - Path=/api-server/**
              filters:
                - StripPrefix=1
            - id: auth-service
              uri: lb://auth-server
              predicates:
                - Path=/auth-server/**
              filters:
                - StripPrefix=1
            - id: gateway-service
              uri: lb://api-server
              predicates:
                - Path=/gateway/api-server/**
              filters:
                - StripPrefix=2

                ## TODO: ì¸ì¦ ì„œë²„ ì¶”ê°€

eureka:
  instance:
    hostname: localhost
    prefer-ip-address: true
    ip-address: 127.0.0.1
    instance-id: ${spring.application.name}:${server.port}
  client:
    register-with-eureka: true
    fetch-registry: true
    service-url:
      defaultZone: http://localhost:8761/eureka/

